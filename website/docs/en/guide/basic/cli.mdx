# CLI

Rstest comes with a lightweight CLI that includes commands such as [rstest watch](#rstest-watch) and [rstest run](#rstest-run).

## rstest -h

`rstest -h` can help you view all available CLI commands and options:

```bash
npx rstest -h
```

The output is shown below:

```bash
Usage:
  $ rstest [...filters]

Commands:
  [...filters]        run tests
  run [...filters]    run tests without watch mode
  watch [...filters]  run tests in watch mode
  list [...filters]   lists all test files that Rstest will run

Options:
  -w, --watch                              Run tests in watch mode
  -h, --help                               Display this message
  -v, --version                            Display version number
  -c, --config <config>
  ...
```

## rstest [...filters]

Running `rstest` directly will enable the Rstest test in the current directory.

```bash
$ npx rstest

âœ“ test/index.test.ts (2 tests) 1ms

  Test Files 1 passed (1)
       Tests 2 passed (2)
    Duration 189 ms (build 22 ms, tests 167 ms)
```

### Watch mode

If you want to automatically rerun the test when the file changes, you can use the `--watch` flag or `rstest watch` command:

```bash
$ npx rstest --watch
```

## rstest run

`rstest run` will perform a single run, and the command is suitable for CI environments or scenarios where tests are not required to be performed while modifying.

## rstest watch

`rstest watch` will start listening mode and execute tests, and when the test or dependent file modifications, the associated test file will be re-execute.

## rstest list

`rstest list` will print a test list of all matching conditions. By default, it prints the test names of all matching tests.

```bash
$ npx rstest list

# the output is shown below:
a.test.ts > test a > test a-1
a.test.ts > test a-2
b.test.ts > test b > test b-1
b.test.ts > test b-2
```

The `rstest list` command inherits all `rstest` filtering options, you can filter files directly or use `-t` to filter the specified test name.

```bash
$ npx rstest list -t='test a'

# the output is shown below:
a.test.ts > test a > test a-1
a.test.ts > test a-2
```

You can use `--filesOnly` to make it print the test files only:

```bash
$ npx rstest list --filesOnly

# the output is shown below:
a.test.ts
b.test.ts
```

You can use `--json` to make it print tests in JSON format in terminal or save the results to a separate file:

```bash
$ npx rstest list --json

$ npx rstest list --json=./output.json
```

You can use `--includeSuites` to print test suites along side test cases:

```bash
$ npx rstest list

# the output is shown below:
a.test.ts > test a
a.test.ts > test a > test a-1
a.test.ts > test a-2
b.test.ts > test b
b.test.ts > test b > test b-1
b.test.ts > test b-2
```

You can use `--printLocation` to print location of tests:

```bash
$ npx rstest list

# the output is shown below:
a.test.ts:4:5 > test a > test a-1
a.test.ts:9:3 > test a-2
b.test.ts:4:5 > test b > test b-1
b.test.ts:9:3 > test b-2
```

## CLI options

Rstest CLI provides several common options that can be used with all commands:

| Flag                            | Description                                                                                                                                                       |
| ------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `-c, --config <config>`         | Specify the configuration file, can be a relative or absolute path, see [Specify config file](/guide/basic/configure-rstest#specify-config-file)                  |
| `--config-loader <loader>`      | Specify the config loader, can be `jiti` or `native`, see [Rsbuild - Specify config loader](https://rsbuild.rs/guide/configuration/rsbuild#specify-config-loader) |
| `-r, --root <root>`             | Specify the project root directory, see [root](/config/test/root)                                                                                                 |
| `--globals`                     | Provide global APIs, see [globals](/config/test/globals)                                                                                                          |
| `--isolate`                     | Run tests in an isolated environment, see [isolate](/config/test/isolate)                                                                                         |
| `--reporter <reporter>`         | Specify the test reporter, see [reporters](/config/test/reporters)                                                                                                |
| `--exclude <exclude>`           | Exclude files from test, see [exclude](/config/test/exclude)                                                                                                      |
| `-u, --update`                  | Update snapshot files, see [update](/config/test/update)                                                                                                          |
| `--coverage`                    | Enable code coverage collection, see [coverage](/config/test/coverage)                                                                                            |
| `--passWithNoTests`             | Allows the test suite to pass when no files are found, see [passWithNoTests](/config/test/pass-with-no-tests)                                                     |
| `--printConsoleTrace`           | Print console traces when calling any console method, see [printConsoleTrace](/config/test/print-console-trace)                                                   |
| `--project <name>`              | Only run tests for the specified project, see [Filter by project name](/guide/basic/test-filter#filter-by-project-name)                                           |
| `--disableConsoleIntercept`     | Disable console intercept, see [disableConsoleIntercept](/config/test/disable-console-intercept)                                                                  |
| `--slowTestThreshold <value>`   | The number of milliseconds after which a test or suite is considered slow, see [slowTestThreshold](/config/test/slow-test-threshold)                              |
| `-t, --testNamePattern <value>` | Run only tests with a name that matches the regex, see [testNamePattern](/config/test/test-name-pattern)                                                          |
| `--testEnvironment <name>`      | The environment that will be used for testing, see [testEnvironment](/config/test/test-environment)                                                               |
| `--testTimeout <value>`         | Timeout of a test in milliseconds, see [testTimeout](/config/test/test-timeout)                                                                                   |
| `--hookTimeout <value>`         | Timeout of hook in milliseconds, see [hookTimeout](/config/test/hook-timeout)                                                                                     |
| `--retry <retry>`               | Number of times to retry a test if it fails, see [retry](/config/test/retry)                                                                                      |
| `--bail [number]`               | Abort the test run after the specified number of test failures, see [bail](/config/test/bail)                                                                     |
| `--browser, --browser.enabled`  | Run tests in Browser Mode, see [browser](/config/test/browser)                                                                                                    |
| `--browser.name <name>`         | Browser to use: `chromium`, `firefox`, `webkit` (default: `chromium`), see [browser](/config/test/browser)                                                        |
| `--browser.headless`            | Run browser in headless mode (default: `true` in CI), see [browser](/config/test/browser)                                                                         |
| `--browser.port <port>`         | Port for the Browser Mode dev server, see [browser](/config/test/browser)                                                                                         |
| `--browser.strictPort`          | Exit if the specified port is already in use, see [browser](/config/test/browser)                                                                                 |
| `--maxConcurrency <value>`      | Maximum number of concurrent tests, see [maxConcurrency](/config/test/max-concurrency)                                                                            |
| `--clearMocks`                  | Automatically clear mock calls, instances, contexts and results before every test, see [clearMocks](/config/test/clear-mocks)                                     |
| `--resetMocks`                  | Automatically reset mock state before every test, see [resetMocks](/config/test/reset-mocks)                                                                      |
| `--restoreMocks`                | Automatically restore mock state and implementation before every test, see [restoreMocks](/config/test/restore-mocks)                                             |
| `--unstubGlobals`               | Restores all global variables that were changed with `rstest.stubGlobal` before every test, see [unstubGlobals](/config/test/unstub-globals)                      |
| `--unstubEnvs`                  | Restores all `process.env` values that were changed with `rstest.stubEnv` before every test, see [unstubEnvs](/config/test/unstub-envs)                           |
| `--include <pattern>`           | Specify test file matching pattern, see [include](/config/test/include)                                                                                           |
| `--includeSource <pattern>`     | Specify in-source testing file matching pattern, see [includeSource](/config/test/include-source)                                                                 |
| `--logHeapUsage`                | Print heap usage for each test, see [logHeapUsage](/config/test/log-heap-usage)                                                                                   |
| `--hideSkippedTests`            | Do not display skipped test logs, see [hideSkippedTests](/config/test/hide-skipped-tests)                                                                         |
| `--hideSkippedTestFiles`        | Do not display skipped test file logs, see [hideSkippedTestFiles](/config/test/hide-skipped-test-files)                                                           |
| `--chaiConfig <config>`         | Customize Chai configuration, see [chaiConfig](/config/test/chai-config)                                                                                          |
| `--env <key=value>`             | Set environment variables, see [env](/config/test/env)                                                                                                            |
| `--pool <type>`                 | Shorthand for `--pool.type`, see [pool](/config/test/pool)                                                                                                        |
| `--pool.type <type>`            | Specify the test pool type, see [pool](/config/test/pool)                                                                                                         |
| `--pool.maxWorkers <value>`     | Maximum number or percentage of workers, see [pool](/config/test/pool)                                                                                            |
| `--pool.minWorkers <value>`     | Minimum number or percentage of workers, see [pool](/config/test/pool)                                                                                            |
| `--pool.execArgv <arg>`         | Additional Node.js execArgv for worker processes (repeatable), see [pool](/config/test/pool)                                                                      |
| `--setupFiles <files>`          | Specify setup files list, see [setupFiles](/config/test/setup-files)                                                                                              |
| `--snapshotFormat <options>`    | Customize snapshot format, see [snapshotFormat](/config/test/snapshot-format)                                                                                     |
| `--resolveSnapshotPath`         | Customize snapshot path resolution, see [resolveSnapshotPath](/config/test/resolve-snapshot-path)                                                                 |
| `--onConsoleLog <handler>`      | Handle console logs, see [onConsoleLog](/config/test/on-console-log)                                                                                              |
| `--name <name>`                 | Set test suite name, see [name](/config/test/name)                                                                                                                |
| `--projects <projects>`         | Configure multi-project testing, see [projects](/config/test/projects)                                                                                            |
| `-h, --help`                    | Display help for command                                                                                                                                          |
| `-v, --version`                 | Display version                                                                                                                                                   |

### Boolean option negation

For boolean options, you can use the `--no-<option>` prefix to set them to `false`. For example:

```bash
# These are equivalent:
npx rstest --isolate false
npx rstest --no-isolate

# More examples:
npx rstest --no-coverage      # Disable coverage
npx rstest --no-globals        # Disable global APIs
npx rstest --no-clearMocks     # Disable auto-clearing mocks
```

## CLI shortcuts

When running Rstest in watch mode, you can use keyboard shortcuts to perform various actions.

All shortcuts:

```bash
  Shortcuts:
  f  rerun failed tests
  a  rerun all tests
  u  update snapshot
  t  filter by a test name regex pattern
  p  filter by a filename regex pattern
  q  quit process
  c  clear screen
  h  show shortcuts help
```

:::note
CLI shortcuts are only available when running Rstest in watch mode (`rstest watch` or `rstest --watch`) and when the terminal supports TTY (interactive mode).
:::
